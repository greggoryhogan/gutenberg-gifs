!function(){"use strict";var e={n:function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,{a:i}),i},d:function(t,i){for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,i=(window.React,window.wp.compose),n=window.wp.apiFetch,a=e.n(n),r=window.wp.blockEditor,s=window.wp.components;wp.i18n.__;var l=e=>{let{gifResults:i,setGif:n,setGifSearch:a,pagePos:r,searchTerm:l,hasNextPage:o,isLoading:c}=e;if(c)return(0,t.createElement)("div",{class:"centercontent"},(0,t.createElement)(s.Spinner,null));let g=!0;(r>0||0==o)&&(g=!1);let u=(0,t.createElement)(s.Button,{className:"is-primary",onClick:e=>{a(l,"prev")},disabled:g},"Previous"),m=!0;null!=r&&0!=o&&(m=!1);let h=(0,t.createElement)(s.Button,{className:"is-primary",onClick:e=>{a(l,"next")},disabled:m},"Next");return i?i.length?(0,t.createElement)("div",null,(0,t.createElement)("div",{class:"gifresults"},i.map((e=>(0,t.createElement)("img",{src:e.preview,width:e.width,height:e.height,url:e.url,onClick:()=>n(e)})))),(0,t.createElement)("div",{class:"gif-navigation"},u,h)):"":(0,t.createElement)("div",null,(0,t.createElement)("div",{class:"gifresults"}),(0,t.createElement)("div",{class:"gif-navigation"},u,h))};const{Fragment:o}=wp.element,{InspectorControls:c}=wp.editor,{PanelBody:g,Text:u}=wp.components,m=wp.i18n.__;var h=(0,i.withState)()((e=>{let{attributes:i,setAttributes:n,searchTerm:a,setGifSearch:u,gifResults:h,pagePos:p,hasNextPage:f,isLoading:d,setGif:w,plugin_settings:E}=e;const{altText:b,currentGif:x}=i,v=sprintf(m('Please enter your Tenor API key on the <a href="%s">settings page</a>.',"gg"),E.gg_settings_page);let T=(0,t.createElement)(s.TextControl,{label:m("Alt text (alternative text)"),value:b,help:(0,t.createElement)(s.ExternalLink,{href:"https://www.w3.org/WAI/tutorials/images/decision-tree"},"Describe the purpose of the image"),onChange:e=>n({altText:e})});x&&""!=E.tenor_api_key||(T="");let _=(0,t.createElement)(o,null,(0,t.createElement)("div",{class:"powered-by"},m("Powered by Tenor")),(0,t.createElement)(s.__experimentalInputControl,{label:m("Set Gif"),placeholder:m("Search Tenor"),value:a,isPressEnterToChange:"true",suffix:(0,t.createElement)(s.Button,{className:"is-primary"},m("Search")),onChange:e=>u(e,"reset")}));return""==E.tenor_api_key&&(_=(0,t.createElement)(o,null,(0,t.createElement)(r.RichText.Content,{tagName:"p",value:v}),(0,t.createElement)(s.Button,{className:"components-button is-secondary",href:E.gg_settings_page},m("Visit Settings Page")))),(0,t.createElement)(o,null,(0,t.createElement)(c,null,(0,t.createElement)(g,{title:m("Settings")},T,_,(0,t.createElement)(l,{gifResults:h,pagePos:p,setGifSearch:u,searchTerm:a,hasNextPage:f,isLoading:d,setGif:w}))))}));const p=wp.i18n.__;var f=e=>{let{attributes:i,setCaption:n,setAttributes:a,plugin_settings:l}=e;const{currentGif:o,currentGifWidth:c,currentGifHeight:g,align:u,captionText:m,altText:h,gifBoxWidth:f,gifBoxHeight:d}=i;if(!o&&""==l.tenor_api_key)return(0,t.createElement)(r.RichText.Content,{tagName:"p",value:sprintf(p('Please enter your Tenor API key on the <a href="%s">settings page</a>.',"gg"),l.gg_settings_page)});if(!o)return(0,t.createElement)("div",{className:"nogif"},(0,t.createElement)(r.RichText.Content,{tagName:"p",value:p("Use the search in the block settings to find a gif...","gg")}));let w=u;u||(w="none");let E="align"+w;return(0,t.createElement)("div",{className:"wp-block-image gg-gif-block"},(0,t.createElement)("figure",{className:E},(0,t.createElement)(s.ResizableBox,{size:{height:d,width:f},minHeight:"50",minWidth:"50",enable:{top:!1,right:!0,bottom:!1,left:!0,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},lockAspectRatio:"true",onResizeStop:(e,t,i,n)=>{a({gifBoxHeight:parseInt(d+n.height,10),gifBoxWidth:parseInt(f+n.width,10)})},onResizeStart:()=>{}},(0,t.createElement)("img",{src:o,width:c,height:g,alt:h})),(0,t.createElement)("figcaption",null,(0,t.createElement)(r.RichText,{tagName:"span",value:m,onChange:e=>n(e),placeholder:p("Enter a caption. Via Tenor")}))))};const d=wp.i18n.__,w=wp.blocks.registerBlockType,{Fragment:E}=wp.element;let b=gg_settings;w("fragment/gif-search-and-embed",{title:d("Gif Search"),description:d("Search and embed gifs directly from Tenor.","gg"),icon:"format-image",category:"media",keywords:[d("Image"),d("Gif")],supports:{align:["left","right","center","full"]},attributes:{currentGif:{type:"string"},currentGifWidth:{type:"number"},currentGifHeight:{type:"number"},altText:{type:"string"},captionText:{type:"string"},gifBoxWidth:{type:"number"},gifBoxHeight:{type:"number"}},example:{attributes:{currentGif:"https://media.tenor.com/images/a8e4ceb0e6e1eaa33da1233bad36bd98/tenor.gif",currentGifWidth:500,currentGifHeight:280,gifBoxWidth:500,gifBoxHeight:280,captionText:"Via Tenor"}},edit:(0,i.withState)({gifResults:[]})((e=>{let{gifResults:i,setState:n,attributes:s,setAttributes:l,searchTerm:o,pagePos:c,hasNextPage:g,isLoading:u}=e;return(0,t.createElement)(E,null,(0,t.createElement)(r.BlockControls,null),(0,t.createElement)(h,{attributes:s,gifResults:i,setAttributes:l,setGifSearch:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"reset"==t?c=0:"prev"==t?c-=1:c+=1,e&&(n({isLoading:!0}),a()({path:"/gg/v1/search/"+e+"/pos/"+c}).then((t=>{g=!0,1==t.last_page&&(g=!1),n({gifResults:t.options,pagePos:c,searchTerm:e,hasNextPage:g,isLoading:!1})})))},searchTerm:o,pagePos:c,hasNextPage:g,isLoading:u,setGif:e=>{l({currentGif:e.url,currentGifWidth:e.width,currentGifHeight:e.height,gifBoxWidth:e.width,gifBoxHeight:e.height})},plugin_settings:b}),(0,t.createElement)(f,{attributes:s,setCaption:e=>{e.includes("Via Tenor")||(e+=" Via Tenor"),l({captionText:e})},setAttributes:l,plugin_settings:b}))})),save:e=>{const{attributes:i}=e,{currentGif:n,currentGifWidth:a,currentGifHeight:s,align:l,captionText:o,altText:c,gifBoxWidth:g}=i;if(!n)return"";let u=l;l||(u="none");let m="align"+u,h="Via Tenor";o&&(h=o);let p="(max-width: "+g+"px) 100vw, "+g+"px";return(0,t.createElement)(E,null,(0,t.createElement)("div",{className:"wp-block-image gg-gif-block"},(0,t.createElement)("figure",{className:m},(0,t.createElement)("div",{className:"components-resizable-box__container"},(0,t.createElement)("img",{src:n,width:g,height:s,alt:c,sizes:p})),(0,t.createElement)("figcaption",null,(0,t.createElement)(r.RichText.Content,{tagName:"span",value:h})))))}})}();